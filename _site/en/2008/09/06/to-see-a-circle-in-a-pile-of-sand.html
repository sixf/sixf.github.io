<p>The other day I sent a small assignment to a group of people in order that they could <em>play</em> with statistics and become more interested with this subject. The data-generating process was quite simple: first I generated 20000 random numbers (10000 rows, 2 columns) from <code>N(0, 1)</code> and then add 10000 rows of numbers which lie exactly on a circle; at last I provided this data in a randomized order so people cannot easily discover the pattern just from the numbers.</p>

<p>The question is, how to reveal the particular pattern in this "pile of sand"? Let's look at the original plot:</p>

<p><img src="http://i.imgur.com/TfwQw.png" alt="The original scatter plot" /></p>

<p>What can we observe from this scatter plot? Perhaps nothing but "a pile of sand". However, if we choose alternative ways to create the plot again, things will be completely different. Here are my approaches:</p>

<h1>1. Use Semi-transparent Colors</h1>

<p>Actually there are 10000 points lying on the circle, so the critical problem is overlapping. In order to show the degree of overlapping, we can use semi-transparent colors, because the color will be more opaque if there are many points at the same place.</p>

<p><img src="http://i.imgur.com/CwPVN.png" alt="Transparent Colors" /></p>

<h1>2. Set Axes Limits</h1>

<p>If we look closer into the plot, the scene will also be different. For example, we only plot the data in the range <code>[-1, 1]</code>.</p>

<p><img src="http://i.imgur.com/szpEf.png" alt="Set Axes Limits" /></p>

<h1>3. Plot with Smaller Point Symbols</h1>

<p>Certainly, small symbols can prevent overlapping effectively in this case.</p>

<p><img src="http://i.imgur.com/xszYg.png" alt="Plot with small symbols" /></p>

<h1>4. Draw A Subset of the Data</h1>

<p>As the problem is that there are too many data points, why not draw a subset and try a scatter plot first? For example, here we have sampled 1000 rows of data and the plot is like this:</p>

<p><img src="http://i.imgur.com/NGl93.png" alt="A subset of the original data" /></p>

<h1>5. Estimate the 2D Density</h1>

<p>The R package <code>KernSmooth</code> has provided functions to estimate the 1D or 2D density.We can further examine the shape of this 2D density using the package <code>rgl</code>. Here is <a href="http://vimeo.com/4745847">an animation</a> recorded to illustrate the 2D density.</p>

<iframe src="http://player.vimeo.com/video/4745847?title=0&amp;byline=0&amp;portrait=0" width="400" height="372" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<p>The R code for the above plots &amp; animation is as follows:</p>

<div class="highlight"><pre><code class="r"><span class="c1"># generate the data</span>
x <span class="o">=</span> rbind<span class="p">(</span>matrix<span class="p">(</span>rnorm<span class="p">(</span><span class="m">10000</span> <span class="o">*</span> <span class="m">2</span><span class="p">),</span> ncol <span class="o">=</span> <span class="m">2</span><span class="p">),</span> local<span class="p">({</span>
  r <span class="o">=</span> runif<span class="p">(</span><span class="m">10000</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">2</span> <span class="o">*</span> pi<span class="p">)</span>
  <span class="m">0.5</span> <span class="o">*</span> cbind<span class="p">(</span>sin<span class="p">(</span>r<span class="p">),</span> cos<span class="p">(</span>r<span class="p">))</span>
<span class="p">}))</span>
x <span class="o">=</span> as.data.frame<span class="p">(</span>x<span class="p">[</span>sample<span class="p">(</span>nrow<span class="p">(</span>x<span class="p">)),</span> <span class="p">])</span>

devAskNewPage<span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="c1"># original plot</span>
plot<span class="p">(</span>x<span class="p">)</span>
<span class="c1"># transparent colors (alpha = 0.1)</span>
plot<span class="p">(</span>x<span class="p">,</span> col <span class="o">=</span> rgb<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.1</span><span class="p">))</span>
<span class="c1"># set axes lmits</span>
plot<span class="p">(</span>x<span class="p">,</span> xlim <span class="o">=</span> c<span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> ylim <span class="o">=</span> c<span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
<span class="c1"># small symbols</span>
plot<span class="p">(</span>x<span class="p">,</span> pch <span class="o">=</span> <span class="s">&quot;.&quot;</span><span class="p">)</span>
<span class="c1"># subset</span>
plot<span class="p">(</span>x<span class="p">[</span>sample<span class="p">(</span>nrow<span class="p">(</span>x<span class="p">),</span> <span class="m">1000</span><span class="p">),</span> <span class="p">])</span>

<span class="c1"># 2D density estimation</span>
library<span class="p">(</span>KernSmooth<span class="p">)</span>
fit <span class="o">=</span> bkde2D<span class="p">(</span>as.matrix<span class="p">(</span>x<span class="p">),</span> c<span class="p">(</span><span class="m">0.1</span><span class="p">,</span> <span class="m">0.1</span><span class="p">))</span>
<span class="c1"># perspective plot by persp()</span>
persp<span class="p">(</span>fit<span class="o">$</span>x1<span class="p">,</span> fit<span class="o">$</span>x2<span class="p">,</span> fit<span class="o">$</span>fhat<span class="p">)</span>

library<span class="p">(</span>rgl<span class="p">)</span>
<span class="c1"># perspective plot by OpenGL</span>
rgl.surface<span class="p">(</span>fit<span class="o">$</span>x1<span class="p">,</span> fit<span class="o">$</span>x2<span class="p">,</span> <span class="m">5</span> <span class="o">*</span> fit<span class="o">$</span>fhat<span class="p">)</span>
<span class="c1"># animation</span>
M <span class="o">=</span> par3d<span class="p">(</span><span class="s">&quot;userMatrix&quot;</span><span class="p">)</span>
play3d<span class="p">(</span>par3dinterp<span class="p">(</span>userMatrix <span class="o">=</span> list<span class="p">(</span>M<span class="p">,</span>
  rotate3d<span class="p">(</span>M<span class="p">,</span> pi<span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> rotate3d<span class="p">(</span>M<span class="p">,</span> pi<span class="o">/</span><span class="m">2</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span>
  rotate3d<span class="p">(</span>M<span class="p">,</span> pi<span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))),</span> duration <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
</code></pre></div>



