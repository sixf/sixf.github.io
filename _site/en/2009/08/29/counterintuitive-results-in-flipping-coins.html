<p>Coin-flipping is a rather old topic in probability theory, so most of us think we know very well about it, however, the other day I saw a question about this old topic (in David Smith's REvolution?) which was beyond me expectation: how many times do we need to flip the coin until we get a sequence of <code>HTH</code> and <code>HTT</code> respectively? (For example, for the sequence HHTH, the number for HTH to appear is 4, and in THTHTT, the number for HTT is 6.)</p>

<p>It seems that the two results are equivalent, as H and T occurs with equal probability 0.5, so we naturally believe the average numbers of steps to HTH and HTT are the same, but the fact is not as we imagined.</p>

<div class="highlight"><pre><code class="r"><span class="c1">## smart guys use math formulae to solve the problem,</span>
<span class="c1">## but *lazy* guys like me use simulations with R</span>
coin.seq <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>v<span class="p">)</span> <span class="p">{</span>
    x <span class="o">=</span> <span class="kc">NULL</span>
    n <span class="o">=</span> <span class="m">0</span>
    <span class="kr">while</span> <span class="p">(</span><span class="o">!</span>identical<span class="p">(</span>x<span class="p">,</span> v<span class="p">))</span> <span class="p">{</span>
        x <span class="o">=</span> append<span class="p">(</span>x<span class="p">[</span>length<span class="p">(</span>x<span class="p">)</span> <span class="o">-</span> <span class="m">1</span><span class="o">:</span><span class="m">0</span><span class="p">],</span> rbinom<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.5</span><span class="p">))</span>
        n <span class="o">=</span> n <span class="o">+</span> <span class="m">1</span>
    <span class="p">}</span>
    n
<span class="p">}</span>
set.seed<span class="p">(</span><span class="m">919</span><span class="p">)</span>
mean<span class="p">(</span>htt <span class="o">&lt;-</span> replicate<span class="p">(</span><span class="m">1e+05</span><span class="p">,</span> coin.seq<span class="p">(</span>c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">))))</span>
<span class="c1"># [1] 8.00304</span>
mean<span class="p">(</span>hth <span class="o">&lt;-</span> replicate<span class="p">(</span><span class="m">1e+05</span><span class="p">,</span> coin.seq<span class="p">(</span>c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))))</span>
<span class="c1"># [1] 10.0062</span>

png<span class="p">(</span><span class="s">&quot;coin-htt-hth.png&quot;</span><span class="p">,</span> height <span class="o">=</span> <span class="m">150</span><span class="p">,</span> width <span class="o">=</span> <span class="m">500</span><span class="p">)</span>
par<span class="p">(</span>mar <span class="o">=</span> c<span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">2.5</span><span class="p">,</span> <span class="m">0.1</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> mgp <span class="o">=</span> c<span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="m">0.8</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
boxplot<span class="p">(</span>list<span class="p">(</span>HTT <span class="o">=</span> htt<span class="p">,</span> HTH <span class="o">=</span> hth<span class="p">),</span> horizontal <span class="o">=</span> <span class="k-Variable">T</span><span class="p">,</span>
    xlab <span class="o">=</span> <span class="s">&quot;n&quot;</span><span class="p">,</span> ylim <span class="o">=</span> range<span class="p">(</span>boxplot<span class="p">(</span>list<span class="p">(</span>HTT <span class="o">=</span> htt<span class="p">,</span> HTH <span class="o">=</span> hth<span class="p">),</span>
        plot <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span><span class="o">$</span>stats<span class="p">))</span>
points<span class="p">(</span>c<span class="p">(</span>mean<span class="p">(</span>htt<span class="p">),</span> mean<span class="p">(</span>hth<span class="p">)),</span> <span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span> pch <span class="o">=</span> <span class="m">19</span><span class="p">)</span>
dev.off<span class="p">()</span>
</code></pre></div>


<p>The answer is counterintuitive, isn't it?</p>

<p><img src="http://i.imgur.com/L8Koq.png" alt="Number of times needed to get HTT and HTH (bold segments are for median; dots denote mean)" /></p>

<p>Well, mathematicians certainly do not like my solution (I guess they even hate such an imprecise approach). I hope some smart guys can give me some hints on working out the probability distribution and hence the expectation.</p>
