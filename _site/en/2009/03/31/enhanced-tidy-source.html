<p>After a few hours' work, I modified the function <code>tidy.source()</code> in the <a href="http://cran.r-project.org/package=formatR">formatR</a> package so that it can preserve <em>complete</em> comment lines. See <code>formatR::tidy.source</code> and <a href="https://github.com/yihui/formatR/wiki">https://github.com/yihui/formatR/wiki</a> for details.</p>
