<p>We know the real distribution of the F statistic in linear models -- it is a non-central F distribution. Under H0, we have a central F distribution. Given 1 - alpha, we can compute the probability of (correctly) rejecting H0. I created a simple demo to illustrate how the power changes as other parameters vary, e.g. the degrees of freedoms, the non-central parameter and alpha. Here is <a href="http://vimeo.com/10647395">the video</a>:</p>

<iframe src="http://player.vimeo.com/video/10647395" width="600" height="749" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>


<p>And for those who might be interested, here is the code (you need to install the <strong>gWidgets</strong> package first and I recommend the <strong>RGtk2</strong> interface). Have fun:</p>

<div class="highlight"><pre><code class="r"><span class="c1">## install.packages(&#39;gWidgetsRGtk2&#39;) first if not installed</span>
<span class="kr">if</span> <span class="p">(</span><span class="o">!</span>require<span class="p">(</span><span class="s">&quot;gWidgetsRGtk2&quot;</span><span class="p">))</span> install.packages<span class="p">(</span><span class="s">&quot;gWidgetsRGtk2&quot;</span><span class="p">)</span>
<span class="kr">if</span> <span class="p">(</span><span class="o">!</span>require<span class="p">(</span><span class="s">&quot;cairoDevice&quot;</span><span class="p">))</span> install.packages<span class="p">(</span><span class="s">&quot;cairoDevice&quot;</span><span class="p">)</span>
library<span class="p">(</span>gWidgetsRGtk2<span class="p">)</span>
options<span class="p">(</span>guiToolkit <span class="o">=</span> <span class="s">&quot;RGtk2&quot;</span><span class="p">)</span>
tbl <span class="o">=</span> glayout<span class="p">(</span>container <span class="o">=</span> gwindow<span class="p">(</span><span class="s">&quot;Power of the F Test&quot;</span><span class="p">),</span> spacing <span class="o">=</span> <span class="m">0</span><span class="p">)</span>
tbl<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span> <span class="o">=</span> g.f <span class="o">=</span> ggraphics<span class="p">(</span>container <span class="o">=</span> tbl<span class="p">,</span>
  expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> ps <span class="o">=</span> <span class="m">11</span><span class="p">)</span>
tbl<span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)]</span> <span class="o">=</span> <span class="s">&quot;numerator df&quot;</span>
tbl<span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span> <span class="o">=</span> g.dfn <span class="o">=</span> gslider<span class="p">(</span>from <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
  to <span class="o">=</span> <span class="m">50</span><span class="p">,</span> value <span class="o">=</span> <span class="m">3</span><span class="p">,</span> container <span class="o">=</span> tbl<span class="p">,</span> handler <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>h<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
      p.Ftest<span class="p">(</span>dfn <span class="o">=</span> svalue<span class="p">(</span>h<span class="o">$</span>obj<span class="p">))</span>
  <span class="p">})</span>
tbl<span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)]</span> <span class="o">=</span> <span class="s">&quot;denominator df&quot;</span>
tbl<span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span> <span class="o">=</span> g.dfd <span class="o">=</span> gslider<span class="p">(</span>from <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
  to <span class="o">=</span> <span class="m">50</span><span class="p">,</span> value <span class="o">=</span> <span class="m">20</span><span class="p">,</span> container <span class="o">=</span> tbl<span class="p">,</span> handler <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>h<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
      p.Ftest<span class="p">(</span>dfd <span class="o">=</span> svalue<span class="p">(</span>h<span class="o">$</span>obj<span class="p">))</span>
  <span class="p">})</span>
tbl<span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)]</span> <span class="o">=</span> <span class="s">&quot;delta^2&quot;</span>
tbl<span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span> <span class="o">=</span> g.ncp <span class="o">=</span> gslider<span class="p">(</span>from <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
  to <span class="o">=</span> <span class="m">100</span><span class="p">,</span> value <span class="o">=</span> <span class="m">10</span><span class="p">,</span> container <span class="o">=</span> tbl<span class="p">,</span> handler <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>h<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
      p.Ftest<span class="p">(</span>ncp <span class="o">=</span> svalue<span class="p">(</span>h<span class="o">$</span>obj<span class="p">))</span>
  <span class="p">})</span>
tbl<span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)]</span> <span class="o">=</span> <span class="s">&quot;alpha&quot;</span>
tbl<span class="p">[</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span> <span class="o">=</span> g.alpha <span class="o">=</span> gslider<span class="p">(</span>from <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
  to <span class="o">=</span> <span class="m">1</span><span class="p">,</span> by <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span> value <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span> container <span class="o">=</span> tbl<span class="p">,</span> handler <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>h<span class="p">,</span>
      <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
      p.Ftest<span class="p">(</span>alpha <span class="o">=</span> svalue<span class="p">(</span>h<span class="o">$</span>obj<span class="p">))</span>
  <span class="p">})</span>
tbl<span class="p">[</span><span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">)]</span> <span class="o">=</span> <span class="s">&quot;x range&quot;</span>
tbl<span class="p">[</span><span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> anchor <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">),</span> expand <span class="o">=</span> <span class="kc">TRUE</span><span class="p">]</span> <span class="o">=</span> g.xr <span class="o">=</span> gslider<span class="p">(</span>from <span class="o">=</span> <span class="m">1</span><span class="p">,</span>
  to <span class="o">=</span> <span class="m">50</span><span class="p">,</span> value <span class="o">=</span> <span class="m">15</span><span class="p">,</span> container <span class="o">=</span> tbl<span class="p">,</span> handler <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>h<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
      p.Ftest<span class="p">(</span>xr <span class="o">=</span> svalue<span class="p">(</span>h<span class="o">$</span>obj<span class="p">))</span>
  <span class="p">})</span>
<span class="c1">## draw the graph</span>
p.Ftest <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>dfn <span class="o">=</span> svalue<span class="p">(</span>g.dfn<span class="p">),</span> dfd <span class="o">=</span> svalue<span class="p">(</span>g.dfd<span class="p">),</span>
  ncp <span class="o">=</span> svalue<span class="p">(</span>g.ncp<span class="p">),</span> alpha <span class="o">=</span> svalue<span class="p">(</span>g.alpha<span class="p">),</span> xr <span class="o">=</span> svalue<span class="p">(</span>g.xr<span class="p">))</span> <span class="p">{</span>
  x <span class="o">=</span> seq<span class="p">(</span><span class="m">0.001</span><span class="p">,</span> xr<span class="p">,</span> length.out <span class="o">=</span> <span class="m">300</span><span class="p">)</span>
  yc <span class="o">=</span> df<span class="p">(</span>x<span class="p">,</span> dfn<span class="p">,</span> dfd<span class="p">)</span>
  yn <span class="o">=</span> df<span class="p">(</span>x<span class="p">,</span> dfn<span class="p">,</span> dfd<span class="p">,</span> ncp <span class="o">=</span> ncp<span class="p">)</span>
  par<span class="p">(</span>mar <span class="o">=</span> c<span class="p">(</span><span class="m">4.5</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0.05</span><span class="p">))</span>
  plot<span class="p">(</span>x<span class="p">,</span> yc<span class="p">,</span> type <span class="o">=</span> <span class="s">&quot;n&quot;</span><span class="p">,</span> ylab <span class="o">=</span> <span class="s">&quot;Density&quot;</span><span class="p">,</span> ylim <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> max<span class="p">(</span>yc<span class="p">,</span> yn<span class="p">)))</span>
  xq <span class="o">=</span> qf<span class="p">(</span><span class="m">1</span> <span class="o">-</span> alpha<span class="p">,</span> dfn<span class="p">,</span> dfd<span class="p">)</span>
  polygon<span class="p">(</span>c<span class="p">(</span>xq<span class="p">,</span> x<span class="p">[</span>x <span class="o">&gt;=</span> xq<span class="p">],</span> xr<span class="p">),</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> yn<span class="p">[</span>x <span class="o">&gt;</span> xq<span class="p">],</span> <span class="m">0</span><span class="p">),</span> col <span class="o">=</span> <span class="s">&quot;gray&quot;</span><span class="p">,</span>
      border <span class="o">=</span> <span class="kc">NA</span><span class="p">)</span>
  lines<span class="p">(</span>x<span class="p">,</span> yc<span class="p">,</span> lty <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
  lines<span class="p">(</span>x<span class="p">,</span> yn<span class="p">,</span> lty <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
  legend<span class="p">(</span><span class="s">&quot;topright&quot;</span><span class="p">,</span> c<span class="p">(</span>as.expression<span class="p">(</span>substitute<span class="p">(</span><span class="k-Variable">F</span><span class="p">[</span>list<span class="p">(</span>df1<span class="p">,</span>
      df2<span class="p">)]</span> <span class="o">~</span> <span class="s">&quot; density&quot;</span><span class="p">,</span> list<span class="p">(</span>df1 <span class="o">=</span> dfn<span class="p">,</span> df2 <span class="o">=</span> dfd<span class="p">))),</span> as.expression<span class="p">(</span>substitute<span class="p">(</span><span class="k-Variable">F</span><span class="p">[</span>list<span class="p">(</span>df1<span class="p">,</span>
      df2<span class="p">)](</span>ncp<span class="p">)</span> <span class="o">~</span> <span class="s">&quot; density&quot;</span><span class="p">,</span> list<span class="p">(</span>df1 <span class="o">=</span> dfn<span class="p">,</span> df2 <span class="o">=</span> dfd<span class="p">,</span> ncp <span class="o">=</span> ncp<span class="p">))),</span>
      as.expression<span class="p">(</span>substitute<span class="p">(</span><span class="s">&quot;Power = &quot;</span> <span class="o">~</span> p<span class="p">,</span> list<span class="p">(</span>p <span class="o">=</span> round<span class="p">(</span><span class="m">1</span> <span class="o">-</span>
          pf<span class="p">(</span>xq<span class="p">,</span> dfn<span class="p">,</span> dfd<span class="p">,</span> ncp <span class="o">=</span> ncp<span class="p">),</span> <span class="m">4</span><span class="p">))))),</span> lty <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span>
      <span class="kc">NA</span><span class="p">),</span> fill <span class="o">=</span> c<span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&quot;gray&quot;</span><span class="p">),</span> border <span class="o">=</span> <span class="kc">NA</span><span class="p">,</span> bty <span class="o">=</span> <span class="s">&quot;n&quot;</span><span class="p">)</span>
  <span class="kr">return</span><span class="p">(</span><span class="m">1</span> <span class="o">-</span> pf<span class="p">(</span>xq<span class="p">,</span> dfn<span class="p">,</span> dfd<span class="p">,</span> ncp <span class="o">=</span> ncp<span class="p">))</span>
<span class="p">}</span>
p.Ftest<span class="p">()</span>
</code></pre></div>



