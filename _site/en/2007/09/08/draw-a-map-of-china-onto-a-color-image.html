<p>What we need to do is just use the parameter <code>add = TRUE</code> in the function of <code>map()</code> (package <strong>maps</strong>):</p>

<p><img src="http://i.imgur.com/jx0ou.png" alt="A Map of China on A Color Image" /></p>

<p>Source code:</p>

<div class="highlight"><pre><code class="r"><span class="kr">if</span> <span class="p">(</span>require<span class="p">(</span>maps<span class="p">)</span> <span class="o">&amp;&amp;</span> require<span class="p">(</span>mapdata<span class="p">))</span> <span class="p">{</span>
  par<span class="p">(</span>mar <span class="o">=</span> c<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span>
  map<span class="p">(</span><span class="s">&quot;china&quot;</span><span class="p">)</span>
  bd <span class="o">=</span> par<span class="p">()</span><span class="o">$</span>usr  <span class="c1">#get the border</span>
  x <span class="o">=</span> seq<span class="p">(</span>bd<span class="p">[</span><span class="m">1</span><span class="p">],</span> bd<span class="p">[</span><span class="m">2</span><span class="p">],</span> length <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
  y <span class="o">=</span> seq<span class="p">(</span>bd<span class="p">[</span><span class="m">3</span><span class="p">],</span> bd<span class="p">[</span><span class="m">4</span><span class="p">],</span> length <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
  z <span class="o">=</span> sqrt<span class="p">(</span>outer<span class="p">((</span>x <span class="o">-</span> mean<span class="p">(</span>x<span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">,</span> <span class="p">(</span>y <span class="o">-</span> mean<span class="p">(</span>y<span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">,</span> <span class="s">&quot;+&quot;</span><span class="p">))</span>
  image<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> z<span class="p">,</span> col <span class="o">=</span> cm.colors<span class="p">(</span><span class="m">25</span><span class="p">),</span> axes <span class="o">=</span> <span class="k-Variable">F</span><span class="p">,</span> xlab <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span> ylab <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
  map<span class="p">(</span><span class="s">&quot;china&quot;</span><span class="p">,</span> add <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="c1"># add the map to the color image</span>
<span class="p">}</span>
</code></pre></div>


<p>Packages <strong>maps</strong> and <strong>mapdata</strong> are required for the map of China.</p>
